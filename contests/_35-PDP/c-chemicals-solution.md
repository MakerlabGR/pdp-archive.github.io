---
layout: solution
codename: chemicals
---

## Επεξήγηση εκφώνησης

Δίνεται ένας πίνακας $$A$$ από $$N$$ στοιχεία και ένας ακέραιος αριθμός $$K$$. Μας ζητείται να βορύμε το μήκος του μεγαλύτερου διαστήματος $$[i, j]$$ ώστε κάθε ζεύγος $$t, s \in [i, j]$$ έχει άθροισμα $$A[s] + A[t]$$ που δεν είναι πολλαπλάσιο του $$K$$.

## Brute force $$\mathcal{O}(N^4)$$

Υπάρχουν συνολικά $$\mathcal{O}(N^2)$$ διαστήματα $$[i, j]$$ και κάθε διάστημα έχει το πολύ $$\mathcal{O}(N^2)$$ ζευγάρια. Επομένως, μπορούμε να ελέγξουμε ένα ένα τα διαστήματα συνολικά σε $$\mathcal{O}(N^4)$$ χρόνο. 

{% include code.md solution_name='brute_force_n4.cc' %}

## Brute force $$\mathcal{O}(N^3)$$

Μπορούμε να επιταχύνουμε την παραπάνω λύση ως εξής: ξέροντας ότι το διάστημα $$[i, j]$$ δεν έχει κάποιο ζευγάρι που να είναι πολλαπλάσιο του $$K$$, τότε για το διάστημα $$[i, j+1]$$ αρκεί να ελέγξουμε ότι τα ζευγάρια $$(i, j+1), \ldots, (j, j+1)$$ έχουν ζευγάρια που δεν είναι πολλαπλάσια του $$K$$. Επειδή υπάρχουν το πολύ $$\mathcal{O}(N)$$ ζευγάρια, ο αλγόριθμος παίρνει συνολικά $$\mathcal{O}(N^3)$$ χρόνο.

{% include code.md solution_name='brute_force_n3.cc' start=18 end=32 %}

## Brute force με hash set $$\mathcal{O}(N^2)$$

Mπορούμε να επιταγχύνουμε περαιτέρω την παραπάνω λύση, κάνοντας την εξής παρατήρηση:

**Παρατήρηση:** Δύο στοιχεία $$A[s]$$ και $$A[t]$$ έχουν άθροισμα πολλαπλάσιο του $$K$$ αν και μόνο αν $$A[s] = (K - A[t]) \% K$$. 

Επομένως, διατηρώντας σε ένα hash set $$S$$ τα στοιχεία $$A[i], \ldots, A[j]$$, μπορούμε να ελέγξουμε γρήγορα αν το στοιχείο $$A[j+1]$$ συμμετέχει σε κάποια δυάδα με άθροιμα $$A[\ell] + A[j+1]$$ που είναι πολλαπλάσιο του $$K$$, κοιτώντας αν υπάρχει το στοιχείο $$(K - A[\ell]) \% K$$ στο $$S$$.

{% include code.md solution_name='brute_hash_set_n2.cc' start=18 end=31 %}

Κάθε πρόσβαση στο hash set θέλει $$\mathcal{O}(1)$$ χρόνο, επομένως συνολικά ο αλγόριθμος θέλει $$\mathcal{O}(N^2)$$.

## Δύο δείκτες $$\mathcal{O}(N)$$

Γενικεύοντας την προηγούμενη λύση, μπορούμε να υπολογίσουμε για κάθε δείκτη $$j$$ το μεγαλύτερο διάστημα $$[\ell, j]$$ για το οποίο δεν υπάρχει ζεύγος $$t, s \in [\ell, j]$$ με άθροισμα $$A[s] + A[t]$$ που δεν είναι πολλαπλάσιο του $$K$$.  Έχοντας την βέλτιση λύση για το $$j$$ έστω $$[\ell, j]$$, μπορούμε να υπολογίσουμε την βέλτιση λύση για το $$j+1$$ μετακινώντας το $$i$$ έως ότου προσπεράσουμε όλα τα στοιχεία ίσα με $$(K - A[j+1]) \% K$$.

{% include code.md solution_name='two_pointers.cc' start=18 end=29 %}

Μπορούμε να μετακινήσουμε το $$\ell$$ το πολύ $$\mathcal{O}(N)$$ φορές, επομένως ο αλγόριθμος θέλει συνολικά $$\mathcal{O}(N)$$ χρόνο.
