---
layout: solution
codename: sumpair
---

## Brute force λύση $$\mathcal{O}(N^2Q)$$
Η πιο απλή λύση είναι για κάθε ερώτημα, να διατρέξουμε όλα τα δυνατά ζεύγη στοιχείων του πίνακα και να δούμε αν έχουν το ζητούμενο άθροισμα.

Κάθε ερώτημα παίρνει $$\mathcal{O}(N^2)$$, άρα η πολυπλοκότητα του αλγορίθμου είναι $$\mathcal{O}(N^2Q)$$ και η μνήμη είναι $$\mathcal{O}(N)$$.

{% include code.md solution_name='sumpair_brute_force.cc' %}

## Λύση με set $$\mathcal{O}(Q N \log N)$$
Στην παραπάνω λύση ψάχνουμε για κάθε $$A[i]$$, αν υπάρχει $$A[j]$$ ώστε $$A[i] + A[j] = \mathit{target}$$. Άρα ψάχνουμε για κάθε $$A[i]$$, αν υπάρχει στοιχείο $$A[j] = \mathit{target} - A[i]$$. 

Η δομή δεδομένων set μπορεί να μας βοηθήσει να απαντήσουμε τέτοιες ερωτήσεις σε χρόνο $$\mathcal{O}(\log N)$$, αφού πρώτα βάλουμε προσθέσουμε όλα τα στοιχεία σε χρόνο $$\mathcal{O}(N \log N)$$.

Ένα σημείο που θέλει προσοχή είναι ότι δεν πρέπει να χρησιμοποιήσουμε το ίδιο στοιχείο δύο φορές, πχ $$15 + 15 = 30$$ στο παράδειγμα. Για να το αποφύγουμε αυτό κρατάμε ένα set από τα στοιχεία που εμφανίζονται τουλάχιστον δύο φορές.

**Σημείωση:** Αν χρησιμοποιήσουμε unordered_set τότε η μέση πολυπλοκότητα γίνεται $$\mathcal{O}(NQ)$$.

{% include code.md solution_name='sumpair_set.cc' %}

## Λύση με δύο δείκτες $$\mathcal{O}(N \log N + Q N)$$
Η βέλτιστη λύση είναι να ταξινομήσουμε τον πίνακα και να διατηρούμε δύο δείκτες $$lo$$ και $$hi$$, ώστε $$[lo, hi]$$ να έχει όλα τα δυνατά ζεύγη που έχουν άθροισμα target.

**Παρατήρηση:** Αν $$A[\mathit{lo}] + A[\mathit{hi}] > \mathit{target}$$, τότε το στοιχείο $$A[\mathit{hi}]$$ δεν μπορεί να είναι σε κανένα ζεύγος με άθροισμα $$\mathit{target}$$. 

*Απόδειξη* Από την υπόθεση, όλα τα ζεύγη με άθροισμα target είναι στο $$[\mathit{lo}, \mathit{hi}]$$. Άρα για $$i \in [\mathit{lo}, \mathit{hi}]$$, $$A[i] + A[\mathit{hi}] \geq A[\mathit{lo}] + A[\mathit{hi}] > \mathit{target}$$. 

Αντίστοιχα, αν $$A[\mathit{lo}] + A[\mathit{hi}] < \mathit{target}$$, τότε το στοιχείο $$A[\mathit{lo}]$$ δεν μπορεί να είναι σε κανένα ζεύγος με άθροισμα $$\mathit{target}$$, γιατί $$A[\mathit{lo}] + A[i] \leq A[\mathit{lo}] + A[i] < target$$.

Αυτές οι παρατηρήσεις μας οδηγούν στον αλγόριθμο όπου αφαιρούμε είτε την αρχή είτε το τέλος από το διάστημα $$[\mathit{lo}, \mathit{hi}]$$ βάσει του $$Α[\mathit{lo}] + Α[\mathit{hi}]$$, μέχρι να βρούμε ένα καλό ζεύγος ή να είναι άδειο το διάστημα. Αφού σε κάθε επανάληψη το μήκος του διαστήματος μικραίνει κατά $$1$$, κάθε ερώτημα θέλει $$\mathcal{O}(N)$$ χρόνο. Άρα ο αλγόριθμος έχει πολυπλοκότητα $$\mathcal{O}(N \log N + Q N)$$ και μνήμη $$\mathcal{O}(N)$$.

{% include code.md solution_name='sumpair_linear_query.cc' %}