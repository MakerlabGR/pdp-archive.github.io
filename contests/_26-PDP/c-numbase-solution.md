---
layout: solution
codename: numbase
---

## Επεξήγηση εκφώνησης
Ο αριθμός $$M$$ μπορεί να γραφτεί σε μία βάση $$K$$ με όλα τα $$n$$ ψηφία του ίδια, αν υπάρχει $$x$$ ώστε

$$x + xK + xK^2 + ... + xK^{(n-1)} = M$$

Κάνουμε τις εξής παρατηρήσεις που βοηθάνε σε όλες τις λύσεις (ή την ανάλυση αυτών):

**Παρατήρηση 1:** Το μέγιστο $$n$$ γίνεται όταν η βάση είναι ελάχιστη, δηλαδή $$K=2$$. Άρα το μέγιστο $$n$$ είναι της τάξης $$\log_2(M)$$.

**Παρατήρηση 2:** Όλοι οι αριθμοί $$M$$ στη βάση $$K = M+1$$ χρησιμοποιούν μόνο ένα στοιχείο, άρα ικανοποιούν την συνθήκη.

## Λύση 1 (30%)
Δοκιμάζουμε όλες τις πιθανές βάσεις $$K < M$$ και δοκιμάζουμε όλα τα πιθανά ψηφία $$x < K$$ αν ικανοποιούν την παραπάνω εξίσωση.

Ο αλγόριθμος έχει πολυπλοκότητα $$\mathcal{O}(M^2 \log M)$$ και σταθερή μνήμη.

{% include code.md solution_name='numbase_brute_force.cc' %}

## Λύση 2 (50%)
Δοκιμάζουμε όλες τις πιθανές βάσεις $$K < M$$ και ελέγχουμε αν η αναπαράσταση έχει όλα τα ίδια ψηφία. 

Η αναπαράσταση ενός αριθμού μπορεί να υπολογιστεί χρησιμοποιώντας τον Ευκλείδειο αλγόριθμο διαίρεσης.

Ο αλγόριθμος έχει πολυπλοκότητα $$\mathcal{O}(M \log M)$$ και σταθερή μνήμη.

{% include code.md solution_name='numbase_50_first.cc' %}

## Λύση 3 (50%)
Σταθεροποιούμε τα $$x$$ και $$n$$, και ορίζουμε 
$$M(K) = x + xK + xK^2 + ... + xK^{(n-1)}$$.
Για μεγαλύτερο $$K$$ παίρνουμε μεγαλύτερες τιμές $$M(K)$$. Επομένως κάνουμε δυαδική αναζήτηση ψάχνοντας το $$K$$ ώστε $$M(K) = M$$. 

Ο αλγόριθμος αυτός έχει πολυπλοκότητα $$\mathcal{O}(M (\log M)^3)$$ και σταθερή μνήμη.

**Σημείωση:** Ο λόγος που χρησιμοποιούμε το γραμμικό άθροισμα αντί τον τύπο για το άθροισμα γεωμετρικής προόδου είναι ότι ο υπολογισμός του μπορεί να κάνει εύκολα overflow.

{% include code.md solution_name='numbase_50_second.cc' %}


## Λύση 4 (100%)
Παραγοντοποιούμε την αρχική σχέση, $$x(1 + K + K^2 + ... + K^{(n-1)}) = M$$.
Επομένως $$x | M$$. Άρα χρειάζεται να ελέγξουμε μόνο για τους διαιρέτες του $$M$$ ως πιθανά ψηφία. 

**Θεώρημα:** Ένας φυσικός αριθμός $$M$$ δεν έχει πάνω από $$2\sqrt{M}$$ διαιρέτες.

*Απόδειξη:* Έστω $$x | M$$, τότε $$M = xy$$ για κάποιον άλλο διαιρέτη $$y$$. Θα δείξουμε ότι αν $$x \neq \sqrt{M}$$, τότε ένας διαιρέτης είναι μεγαλύτερος από $$\sqrt{M}$$ και ένας μικρότερος. 
Αν $$x > \sqrt{M}$$ και $$y > \sqrt{M}$$, τότε $$M = xy > \sqrt{M}^2 = M$$ (άτοπο). Αντίστοιχα για την περίπτωση που $$x < \sqrt{M}$$ και $$y < \sqrt{M}$$. Άρα ένας διαιρέτης είναι μεγαλύτερος από $$\sqrt{M}$$ και ένας μικρότερος.
Αυτό σημαίνει ότι κάθε διαιρέτης $$d_1 > \sqrt{M}$$ του $$M$$ αντιστοιχεί σε έναν διαιρέτη $$d_2 < \sqrt{M}$$ του $$M$$. Συνεπώς υπάρχουν το πολύ $$2 \sqrt{M} - 1$$ διαιρέτες (μετρώντας τον $$\sqrt{M}$$ το πολύ μία φορά).

Με το παραπάνω θεώρημα μπορούμε θα περιορίσουμε τους αριθμούς $$x$$ που θα ελέγξουμε και να επιταχύνουμε τη Λύση 3. Ο αλγόριθμος αυτός έχει πολυπλοκότητα $$\mathcal{O}(\sqrt{M} (\log M)^3)$$ και σταθερή μνήμη.

{% include code.md solution_name='numbase_correct.cc' %}