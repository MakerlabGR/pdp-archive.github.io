---
layout: solution
codename: shroompath
---

## Επεξήγηση εκφώνησης
Έχουμε όλους τους δυνατούς συνδυασμούς των γραμμάτων **α** και **β** σε συμβολοσειρές μήκους $$1,2,3,\dots \infty$$.  
Για κάθε ξεχωριστό μήκος, οι συμβολοσειρές είναι ταξινομημένες αλφαβητικά. 
Όλες οι συμβολοσειρές που προκύπτουν, κολλάνε μεταξύ τους 
(χωρίς κενά ενδιάμεσα) παράγοντας μια ατέρμονη συμβολοσειρά. 

<center>
<img alt="Παράδειγμα για μήκη 1,2,3" src="/assets/37-b-shroompath-exp1.svg" width="480px">
</center>

Για κάθε γράμμα **α** ή **β** έχουμε ένα συγκεκριμένο βάρος ($$X$$ και $$Y$$ αντίστοιχα). Zητείται πότε θα έχουμε 
συγκεντρώσει συνολικό βάρος μεγέθους τουλάχιστον $$S$$ ως άθροισμα συνεχόμενων *ίδιων* γραμμάτων **α** ή **β**.

**Παρατήρηση 1:** εφόσον θέλουμε το βάρος $$S$$ να αποτελείται αποκλειστικά από ίδια γράμματα 
(έστω $$A$$ γράμματα **α** ή $$B$$ γράμματα **β**), αρκεί να διαιρέσουμε το 
βάρος $$S$$ με το βάρος $$X$$ ή $$Y$$ *στρογγυλοποιώντας προς τα πάνω*, για να υπολογίσουμε τα $$A$$ και $$B$$. 
Στα μαθηματικά ο συμβολισμός για τη στρογγυλοποίηση προς τα πάνω είναι 
$$A = \lceil S/X \rceil, B = \lceil S/Y \rceil$$.  
H συνάρτηση ``ceil`` της βιβλιοθήκης ``cmath`` κάνει ακριβώς αυτή τη στρογγυλοποίηση.
Εναλλακτικά, στη ``c++`` γνωρίζουμε ότι η ακέραια διαίρεση αγνοεί τυχόν δεκαδικά ψηφία, οπότε για το $$A$$ 
αρκεί να κάνουμε τον υπολογισμό $$ A = (S+X-1)/X$$ (δηλαδή αυξάνουμε τόσο το $$S$$, 
ώστε να αυξήσει το πηλίκο αν και μόνο αν η διαίρεση 
του $$S$$ με το $$X$$ δεν είναι τέλεια). 

## Υποπρόβλημα 1 ($$ S\le 15 $$)

Στο υποπρόβλημα αυτό θα χρειαστεί να εξερευνήσουμε τις συμβολοσειρές με μήκος $$1,2,\dots ,S$$, καθώς ο 
πρώτος συνδυασμός συμβολοσειρών μήκους $$S$$ αποτελείται από $$S$$ **α** και ο τελευταίος από $$S$$ **β**. 
Μάλιστα αν τα $$X$$ και $$Y$$ είναι μεγαλύτερα από $$1$$, θα καταφέρουμε να συγκεντρώσουμε 
βάρος $$S$$ ακόμα πιο γρήγορα. 
Ακολουθούν δύο τρόποι για να υπολογίσουμε όλους τους συνδυασμούς, με αναδρομή και με βρόγχο. 

**Αναδρομικά:** Βρίσκουμε όλους τους συνδυασμούς για κάθε μήκος συμβολοσειράς και τους προσθέσουμε σε έναν πίνακα 
χαρακτήρων ``Z``. 

{% include code.md solution_name='shroom_brute1.cc' start=10 end=21 %}

Κατόπιν με τη χρήση της συνάρτησης ``search`` της βιβλιοθήκης ``algorithm`` βρίσκουμε την 
πρώτη θέση που ξεκινούν τα $$A$$ συνεχόμενα **α** ή τα $$B$$ συνεχόμενα **β** που αναζητούμε.

{% include code.md solution_name='shroom_brute1.cc' start=35 end=44 %}

**Παρατήρηση 2:** Το πλήθος των συμβολοσειρών μήκους $$i$$ από τα δύο γράμματα, είναι $$2^i$$ (εφόσον κάθε θέση μπορεί να έχει 
$$2$$ τιμές). Τα **α** και **β** μπορούν να θεωρηθούν ως οι αριθμοί $$0$$ και $$1$$ του δυαδικού συστήματος και η 
παραγόμενη συμβολοσειρά να είναι η αλληλουχία όλων των μη μηδενικών φυσικών αριθμών απεικονισμένων στο δυαδικό σύστημα. 

**Με βρόγχο:** Γνωρίζοντας από την *παρατήρηση 2* το πλήθος των συμβολοσειρών, τις κατασκευάζουμε με βρόγχο. 

{% include code.md solution_name='shroom_brute2.cc' start=10 end=14 %}

Η λύση χρειάζεται $$\mathcal{O}(S\cdot 2^S)$$ χρόνο.
Μπορείτε να βρείτε ολόκληρο τον κώδικα των δύο παραπάνω λύσεων 
[εδώ (αναδρομικά)]({% include link_to_source.md solution_name='shroom_brute1.cc' %}) και 
[εδώ (με βρόγχο)]({% include link_to_source.md solution_name='shroom_brute2.cc' %}). 

## Υποπρόβλημα 2 ($$ Χ\gt Y $$)

Εφόσον οι χαρακτήρες τύπου **α** έχουν μεγαλύτερο βάρος, θα προλάβουμε να συγκεντρώσουμε το συνολικό βάρος $$S$$ με αυτά.
Τα μανιτάρια **β** δεν θα μας χρησιμεύσουν. 

**Παρατήρηση 3:** Για οποιοδήποτε μήκος $$w$$ συμβολοσειρών με $$w\gt 1$$, η πρώτη συμβολοσειρά αποτελείται από $$w$$ **α** και 
η επόμενη από $$w-1$$ **α** και ένα **β**. Σε καμία άλλη θέση δεν έχουμε τόσα **α** συγκεντρωμένα.

<center>
<img alt="Μεγάλος συνδυασμός α" src="/assets/37-b-shroompath-a.svg" width="480px">
</center>

Γνωρίζοντας το πλήθος των συμβολοσειρών για κάποιο μήκος (*παρατήρηση 2*) και τη θέση που 
βρίσκονται τα περισσότερα συγκεντρωμένα **α** (*παρατήρηση 3*), δεν χρειάζεται να κατασκευάσουμε 
τις συμβολοσειρές παρά μόνο να υπολογίσουμε πόσοι χαρακτήρες υπήρξαν σε όλα τα προηγούμενα μήκη συνδυασμών 
και σε ποιά θέση συγκεντρώσαμε τα απαραίτητα **α**.

{% include code.md solution_name='shroom_only_a.cc' start=8 end=17 %}
Ο χρόνος που χρειάζεται αυτή η λύση είναι $$\mathcal{O}(S)$$.
Ολόκληρος ο κώδικας [εδώ]({% include link_to_source.md solution_name='shroom_only_a.cc' %}).

## Υποπρόβλημα 3 ($$ Χ=0 $$)

Στο υποπρόβλημα αυτό, τα **α** έχουν μηδενικό βάρος και δεν χρησιμεύουν. Παρατηρώντας την παρακάτω εικόνα είναι 
φανερό ότι η μέγιστη συγκέντρωση από **β** βρίσκεται στο μέσο σχεδόν των συμβολοσειρών μήκους $$B$$. Πιο 
συγκεκριμένα, οι πρώτες μισές συμβολοσειρές έχουν **α** στην πρώτη θέση και οι επόμενες μισές έχουν **β** στην πρώτη θέση. 
Η τελευταία συμβολοσειρά με **α** πρώτο χαρακτήρα, έχει $$B-1$$ χαρακτήρες **β** να ακολουθούν και αμέσως 
μετά ακολουθεί η πρώτη συμβολοσειρά με ένα **β** στην πρώτη θέση. Αυτή είναι και η θέση που καταφέρνουμε 
να συγκεντρώσουμε τα $$B$$ **β**, δηλαδή μια θέση μετά τους μισούς χαρακτήρες των συνδυασμών μήκους $$B$$.

<center>
<img alt="Μεγάλος συνδυασμός β" src="/assets/37-b-shroompath-b.svg" width="480px">
</center>
 
{% include code.md solution_name='shroom_only_b.cc' start=8 end=18 %}
Ο χρόνος που χρειάζεται η λύση αυτή είναι $$\mathcal{O}(S)$$.
Ολόκληρος ο κώδικας [εδώ]({% include link_to_source.md solution_name='shroom_only_b.cc' %}).

## Πλήρης λύση σε χρόνο $$\mathcal{O}(S)$$

Εφόσον γνωρίζουμε τις συγκεντρώσεις $$A$$ ή $$B$$ που χρειαζόμαστε για βάρος $$S$$, πρέπει να βρούμε μετά από πόσους 
χαρακτήρες θα τις καταφέρουμε. Οι χαρακτήρες **α** και **β** όμως είναι τόσα πολλοί που 
ξεπερνούν τα όρια των ακεραίων τύπων που παρέχει η ``c++`` και δεν μπορούμε να αποθηκεύσουμε 
τις θέσεις που τα βρήκαμε παρά μόνο αν αποθηκεύσουμε τα υπόλοιπα των θέσεων με 
κάποιον διαιρέτη όπως το $$10^9+7$$ που μας δίνει η εκφώνηση. 
Η διάταξη των θέσεων έχει χαθεί από τη στιγμή που κρατάμε μόνο τα υπόλοιπα τους, 
οπότε υπολογίζουμε προοδευτικά τους συνδυασμούς 
**α** και **β** που συναντάμε και σταματάμε μόλις βρούμε την πρώτη λύση.

{% include code.md solution_name='shroom_solution1.cc' start=8 end=18 %}
Ολόκληρος ο κώδικας [εδώ]({% include link_to_source.md solution_name='shroom_solution1.cc' %}). 

Αν όμως αξιοποιήσουμε την πληροφορία ότι τα $$B$$ μανιτάρια τύπου **β** τα συναντάμε στις συμβολοσειρές μήκους $$B$$, είναι 
φανερό ότι μέχρι και $$2\cdot B-1$$ μανιτάρια τύπου **α** τα βρίσκουμε νωρίτερα από τα $$B$$ **β**. 

<center>
<img alt="Όλοι οι συνδυασμοί" src="/assets/37-b-shroompath-full.svg" width="480px">
</center>

Ενώνοντας τις λύσεις των δύο προηγούμενων υποπροβλημάτων, έχουμε: 

{% include code.md solution_name='shroom_solution2.cc' start=26 end=33 %}
Ολόκληρος ο κώδικας [εδώ]({% include link_to_source.md solution_name='shroom_solution2.cc' %}). 
Οι παραπάνω λύσεις χρειάζονται χρόνο $$\mathcal{O}(S)$$.

## Πλήρης λύση σε χρόνο $$\mathcal{O}(\log_2{S})$$

Ο αριθμός των χαρακτήρων από όλους τους συνδυασμούς ενός μόνο πλάτους $$k$$, 
δίνεται από τη συνάρτηση  
$$f(k) = 2^k \cdot k$$. Ο υπολογισμός του συνόλου των μανιταριών μέχρι και το πλάτος $$k$$, δίνεται από 
τη συνάρτηση  $$p(k) = f(1)+f(2)+\dots+f(k)=\sum_{i=1}^{k}f(i) = \sum_{i=1}^{k} {i\cdot 2^i}$$.<br>  
Η συνάρτηση αυτή μπορεί να υπολογισθεί με 
$$p(k) = 2^{k+1}\cdot (k-1)+2$$

*Απόδειξη:* <br>
Θα χρησιμοποιήσουμε επαγωγή. <br>
Για $$k=1$$, έχουμε $$p(1) = 2^{1+1}\cdot {1-1} +2 = 2$$ το οποίο ισχύει (έχουμε $$2$$ χαρακτήρες, ένα **α** και ένα **β** στους συνδυασμούς με μήκος $$1$$).<br>
Έστω ότι ισχύει για κάποιο $$k$$, δηλαδή $$p(k) = 2^{k+1}\cdot (k-1)+2$$,<br>
θα αποδείξουμε ότι ισχύει και για το $$k+1$$, δηλαδή:<br>
$$p(k+1)=2^{(k+1)+1}\cdot ((k+1)-1)+2 =2^{k+2}\cdot k + 2$$.<br>

Γνωρίζουμε ότι<br>
$$\begin{aligned}
p(k+1) =\\
p(k) + f(k+1) =\\
2^{k+1}\cdot (k-1)+2 + 2^{k+1} \cdot (k+1)=\\ 
2^{k+1}\cdot k - 2^{k+1} + 2 + 2^{k+1}\cdot k + 2^{k+1}=\\
2^{k+1}\cdot k - \cancel{2^{k+1}} + 2 + 2^{k+1}\cdot k + \cancel{2^{k+1}}=\\
2^{k+1}\cdot k + 2^{k+1}\cdot k + 2=\\
2\cdot 2^{k+1} \cdot k + 2=\\
2^{k+2}\cdot k +2
\end{aligned}$$<br>
άρα καταλήγουμε ότι ισχύει η $$p(k+1)$$, άρα η σχέση μας ισχύει για όλα τα $$k\ge1$$.

Ο υπολογισμός της δύναμης με τη συνάρτηση ``pow2`` στην παραπάνω λύση, χρειάζεται 
λογαριθμικό χρόνο ως προς τον εκθέτη (μέγιστος εκθέτης ο $$S$$), 
οπότε ο χρόνος που χρειάζεται συνολικά η λύση είναι $$\mathcal{O}(\log_2{S})$$. 
Ο σχετικός κώδικας ακολουθεί:
{% include code.md solution_name='shroom_solution3_math.cc' start=17 end=32 %}
Ολόκληρος ο κώδικας [εδώ]({% include link_to_source.md solution_name='shroom_solution3_math.cc' %}) 
