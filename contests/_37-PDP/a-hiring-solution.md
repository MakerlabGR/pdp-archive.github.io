---
layout: solution
codename: hiring
---

## Επεξήγηση εκφώνησης

Σε αυτό το πρόβλημα μας δίνονται τρία συμβόλαια για κάθε έναν από τους $$N$$ πιτσαδόρους, με τιμές απόδοσης $$A_i \leq B_i \leq C_i$$ για τον $$i$$-οστό πιτσαδόρο. Σκοπός είναι να αναθέσουμε ένα από τα τρία συμβόλαια στον κάθε πιτσαδόρο ώστε να μεγιστοποιήσουμε το σύνολο των αποδόσεων, με τον περιορισμό ότι μπορεί να έχουμε το πολύ $$Χ$$ συμβόλαια του πρώτου τύπου (χάλκινα), $$Y$$ του δεύτερου (ασημένια) και $$Z$$ του τρίτου (χρυσά). 

## Λύση ωμής βίας

Η λύση της *ωμής βίας* είναι να δοκιμάσουμε όλους τους δυνατούς τρόπους να αναθέσουμε τα συμβόλαια στους πιτσαδόρους ώστε να ικανοποιούνται οι περιορισμοί, και επιλέγουμε αυτόν που μεγιστοποιεί την απόδοση.

Υπάρχουν το πολύ τρία δυνατά συμβόλαια για κάθε πιτσαδόρο, επομένως πρέπει να ελέγξουμε το πολύ $$O(3^N)$$ δυνατούς τρόπους, που είναι εκθετικά πολλοί. Η λύση αυτή περνάει μόνο το πρώτο υποπρόβλημα. Μία ενδεικτική αναδρομική υλοποίηση είναι η παρακάτω.

{% include code.md solution_name='hiring_brute_force.cc' start=16 end=24 %}

Δείτε ολόκληρο τον κώδικα [εδώ]({% include link_to_source.md solution_name='hiring_brute_force.cc' %}).

## Λύση για το 2ο και 3ο υποπρόβλημα

Στο 2ο και 3ο υποπρόβλημα υπάρχουν μόνο δύο είδη συμβολαίων (ας υποθέσουμε μόνο χάλκινα και ασημένια). Ξέρουμε ότι κάθε συμβόλαιο θα είναι είτε χάλκινο με απόδοση $$A_i$$ είτε ασημένιο με απόδοση $$B_i$$, και ότι $$B_i \geq A_i$$. Άρα αυτό που κερδίζουμε κάνοντας το $$i$$-οστό συμβόλαιο ασημένιο είναι η διαφορά $$B_i - A_i$$. Επομένως, για να μεγιστοποιήσουμε την συνολική απόδοση, ταξινομούμε ως προς τις διαφορές και βάζουμε τις $$Y$$ μεγαλύτερες. 

{% include code.md solution_name='hiring_subtask_2.cc' start=25 end=34 %}

Η ταξινόμηση χρειάζεται $$O(N \log N)$$ χρόνο, συνεπώς ο αλγόριθμος χρειάζεται $$O(N \log N)$$ χρόνο. Μπορούμε επίσης να χρησιμοποιήσουμε τον αλγόριθμο για το ``nth_element``, για να ρίξουμε την πολυπλοκότητα σε $$O(N)$$. Δείτε ολόκληρο τον κώδικα [εδώ]({% include link_to_source.md solution_name='hiring_subtask_2.cc' %}) και [εδώ]({% include link_to_source.md solution_name='hiring_subtask_3.cc' %}).

## Λύση για το 4ο υποπρόβλημα

Σε αυτό το υποπρόβλημα μας δίνεται επιπλέον ότι $$A_1 = \ldots = A_N$$, $$B_1 \leq \ldots \leq B_N$$ και $$C_1 \geq \ldots \geq C_N$$. Η βασική παρατήρηση εδώ είναι ότι μας συμφέρει να βάλουμε τα πρώτα $$Z$$ στα χρυσά και τα τελευταία $$Y$$ από τα υπόλοιπα στα ασημένια. Αυτό μπορεί να υλοποιηθεί με τον εξής άπληστο αλγόριθμο:

{% include code.md solution_name='hiring_subtask_4.cc' start=16 end=22 %}

Ο αλγόριθμος διατρέχει μία φορά τα δεδομένα επομένως χρειάζεται $$O(N)$$ χρόνο και χρησιμοποιεί $$O(1)$$ μνήμη. Δείτε ολόκληρο τον κώδικα [εδώ]({% include link_to_source.md solution_name='hiring_subtask_4.cc' %}).

## Λύση για το 5ο υποπρόβλημα

Το 5ο υποπρόβλημα μοιάζει με το 2ο και το 3ο, με την διαφορά ότι έχουμε επιπλέον, ένα χρυσό συμβόλαιο. Αυτό που μπορούμε να κάνουμε είναι να θεωρήσουμε κάθε μία από τις $$N$$ πιθανές εκδοχές για το ποιος θα πάρει χρυσό συμβόλαιο και τα συμβόλαια των υπόλοιπων πιτσαδόρων να τα αναθέσουμε με τον αλγόριθμο που χρησιμοποιήσαμε προηγουμένως. Κάτι τέτοιο θα χρειαζόταν $$O(N^2 \log N)$$ χρόνο που είναι σχετικά αργό. 

Αυτό όμως που παρατηρούμε είναι ότι κάθε φορά που δοκιμάζουμε ένα άλλο $$i$$ για να είναι το χρυσό συμβόλαιο, η λύση δεν αλλάζει πολύ. Για την ακρίβεια υπάρχουν οι εξής δύο περιπτώσεις:
 1. Το $$i$$ δεν ανήκει στις $$Y$$ μεγαλύτερες διαφορές $$B_i - A_i$$, επομένως η απόδοση αυξάνεται κατά την διαφορά $$C_i - A_i$$. 
 2. Το $$i$$ ανήκει στις $$Y$$ μεγαλύτερες διαφορές $$B_i - A_i$$, επομένως η απόδοση αυξάνεται κατά την διαφορά $$C_i - B_i$$. Το ασημένιο συμβόλαιο του $$i$$-οστού πιτσαδόρου θα διατεθεί στον πιτσαδόρο με κατάταξη $$Y+1$$, και η απόδοση αυξάνεται επιπλέον κατά $$B_{Y+1} - A_{Y+1}$$.
 
Ο παρακάτω κώδικας υλοποιεί αυτήν την ιδέα και χρειάζεται $$O(N \log N)$$ χρόνο. 
{% include code.md solution_name='hiring_subtask_5.cc' start=35 end=48 %}

Δείτε ολόκληρο τον κώδικα [εδώ]({% include link_to_source.md solution_name='hiring_subtask_5.cc' %}).

## Γενική λύση

Για να λύσουμε την γενική περίπτωση θα γενικεύσουμε την λύση για το 5ο υποπρόβλημα. Θα ξεκινήσουμε βρίσκοντας μία λύση που έχει $$Y$$ ασημένια και $$N-Y$$ χάλκινα συμβόλαια. Έπειτα θα προσθέτουμε ένα ένα τα χρυσά συμβόλαια. Κάθε φορά που προσθέτουμε ένα χρυσό συμβόλαιο έχουμε πάλι δύο επιλογές
1. Κάνουμε ένα από τα χάλκινα συμβόλαια $$i$$ χρυσό, με αλλαγή απόδοσης $$C_i - A_i$$, ή
2. Κάνουμε ένα από τα ασημένια συμβόλαια $$i$$ χρυσό (με αλλαγή απόδοσης $$C_i - B_i$$) και ένα από τα χάλκινα συμβόλαια $$j$$ ασημένιο (με αλλαγή απόδοσης $$B_j - A_j$$).

Σε κάθε βήμα θέλουμε να βρούμε ποια αλλαγή μεγιστοποιεί την απόδοση. Για να το κάνουμε αυτό αποδοτικά κρατάμε τρεις ουρές προτεραιότητας: την ``from_a_to_b`` που κρατάει τις αλλαγές αποδόσεων από χάλκινα σε ασημένια, την ``from_a_to_c`` και την ``from_b_to_c``, αντίστοιχα. Τότε, μπορούμε να ελέγξουμε την μέγιστη αύξηση της απόδοσης για τις δύο περιπτώσεις:
1. Περίπτωση 1η: Βρίσκουμε το συμβόλαιο $$i$$ που έχει την τιμή ``from_a_to_c.front()`` (αν υπάρχει).
2. Περίπτωση 2η: Βρίσκουμε το συμβόλαιο $$i$$ που έχει την τιμή ``from_b_to_c.front()`` και το συμβόλαιο $$j$$ που έχει την τιμή ``from_a_to_b.front()`` (αν υπάρχουν).

Αν η πρώτη περίπτωση έχει μεγαλύτερη αύξηση, τότε αλλάζουμε το $$i$$ σε χρυσό, διαφορετικά αλλάζουμε το $$i$$ σε χρυσό και το $$j$$ σε ασημένιο.

Οι λεπτομέρειες δίνονται στον παρακάτω κώδικα:
{% include code.md solution_name='hiring_efficient.cc' start=33 end=78 %}

Δείτε ολόκληρο τον κώδικα [εδώ]({% include link_to_source.md solution_name='hiring_efficient.cc' %}).
