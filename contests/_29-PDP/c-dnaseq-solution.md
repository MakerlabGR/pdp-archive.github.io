---
layout: solution
codename: dnaseq
---
## Επεξήγηση εκφώνησης
Το πρόβλημα μας δίνει δύο ακολουθίες $$A$$ και $$B$$ και εμείς πρέπει να βρούμε ακουλουθίες $$X$$, $$Y$$ και $$Z$$, ώστε $$A = XYZ$$ και $$B = X\overline{Y}Z$$, και το μήκος της $$Y$$ να είναι ελάχιστο. Ο συμβολισμός $$\overline{Y}$$ σημαίνει η ακολουθία $$Y$$ αντρίστροφα (πχ αν $$Y = ``abc"$$ τότε $$\overline{Y} = ``cba"$$).

## Brute force
Η πιο απλή λύση είναι να δοκιμάσουμε όλα τα δυνατά $$L$$ και $$M$$, και να ελέγξουμε σε γραμμικό χρόνο αν ικανοποιούν τις συνθήκες.

Ο αλγόριθμος αυτός έχει πολυπλοκότητα $$\mathcal{O}(N^3)$$ και χρειάζεται $$\mathcal{O}(N)$$ μνήμη.

{% include code.md solution_name='dnaseq_brute_force.cc' %}

## Λύση με rolling hash
*Η λύση αυτή προϋποθέτει ότι γνωρίζεται τι είναι το rolling hash.*

Μπορούμε να επιταχύνουμε την προηγούμενη λύση χρησιμοποιώντας rolling hash για να συγκρίνουμε ακολουθίες. Κρατάμε $$\mathit{RA}[i] = (\sum_{k=1}^i A[i] \cdot x^i) \mod p$$ και $$\mathit{LA}[i] = (\sum_{k=i}^{N} B[i] \cdot x^{(N-i+1)}) \mod p$$ για έναν πρώτο αριθμό $$p$$ και μία βάση $$p > x > 1$$.

Οι δοσμένες συνθήκες μπορούν να επαληθευτούν ως εξής:
1. $$\mathit{RA}[L-1] == \mathit{RB}[L-1]$$,
2. $$\mathit{LA}[M+1] == \mathit{LB}[M+1]$$,
3. $$(\mathit{RA}[M] - \mathit{RA}[L-1])\cdot x^{(N-M+1)} == (\mathit{LB}[L] - \mathit{LA}[M+1])\cdot x^{L}$$ (ο πολλαπλασιασμός με τις δυνάμεις του $$x$$ χρειάζεται ώστε οι δύο ακολουθίες που συγκρίνουμε να ξεκινάμε από την ίδια δύναμη (την $$x^{(N-M+L+1)}$$).

{% include code.md solution_name='dnaseq_rolling_hash.cc' %}

Ο αλγόριθμος αυτός έχει πολυπλοκότητα $$\mathcal{O}(N^2)$$ και χρειάζεται $$\mathcal{O}(N)$$ μνήμη. Το πρόβλημα του είναι ότι με κάποια *μικρή* πιθανότητα μπορεί να βρει λάθος απάντηση (το hash μπορεί να είναι ίδιο αλλά οι ακολουθίες όχι).

## Βέλτιστη λύση
Η βέλτιστη λύση είναι να κάνουμε τα $$X$$ και $$Z$$ όσο πιο μεγάλα γίνεται και μετά να ελέγξουμε ότι οι μεσαίες υποακολουθίες είναι αντίστροφες.

Αυτός ο αλγόριθμος έχει πολυπλοκότητα $$\mathcal{O}(N)$$ και χρειάζεται $$\mathcal{O}(N)$$ μνήμη.

{% include code.md solution_name='dnaseq_efficient.cc' %}

Ακολουθεί η απόδειξη ορθότητας (που δεν είναι αναγκαία για τον διαγωνισμό).

**Θεώρημα:** Αν οι ακολουθίες συσχετίζονται, τότε ο παραπάνω αλγόριθμος δίνει σωστά $$X$$, $$Y$$ και $$Z$$.

*Απόδειξη.* Πρέπει να δείξουμε ότι αν ακολουθήσουμε τον παραπάνω αλγόριθμο και η μία μεσαία ακολουθία $$M_1$$ του $$A$$ δεν είναι η αντίστροφη της μεσαίας ακολουθίας $$M_2$$ στο $$B$$, τότε οι ακολουθίες δεν γίνεται να συσχετίζονται.

Έστω ότι $$A$$ και $$B$$ συσχετίζονται και ας υποθέσουμε ότι οι $$a$$ και $$b$$ είναι οι ακολουθίες με το ελάχιστο συνολικό μήκος με $$M_1' = aM_1b$$ και $$M_2' = aM_2b$$, ώστε $$M_1' = \overline{M_2'}$$. Τότε $$aM_1b = \overline{b}\overline{M_2}\overline{a}$$ και συνεπώς $$a$$ και $$\overline{b}$$ έχουν κοινό prefix. Άρα υπάρχει ένα γράμμα $$k$$ ώστε $$a = ka'$$ και $$b = b'k$$. Άρα $$M_1' = ka'M_1b'k$$ και $$M_2' = ka'M_2b'k$$. 

Άρα οι ακολουθίες $$M_1'' =a'M_1b'$$ και $$M_2'' = a'M_2b'$$, είναι αντίστροφες. Αλλά $$a'$$ και $$b'$$ έχουν μικρότερο συνολικό μήκος (κατά $$2$$) από αυτό των $$a$$ και $$b$$. Άτοπο, γιατί υποθέσαμε ότι αυτό ήταν το ελάχιστο.

<center>
<img src="/assets/29-pdp-c-dnaseq-explanation-1.svg" alt="Διαγραμμα για την πρώτη αιτιολόγηση." width="90%"/>
</center>

**Σημείωση:** Αν το $$a$$ ή το $$b$$ είναι κενές ακολουθίες τότε το $$k$$ ανήκει στο $$M_1$$ (και στο $$M_2$$), που είναι αντίθετο στο ότι ο αλγόριθμος βρίσκει το μεγαλύτερο prefix (και suffix) μεταξύ των $$A$$ και $$B$$. Για παράδειγμα, αν η $$b$$ είναι κενή τότε, ο αλγόριθμος δεν είχε βρει το μεγαλύτερο κοινό suffix:

<center>
<img src="/assets/29-pdp-c-dnaseq-explanation-2.svg" alt="Διαγραμμα για την δεύτερη αιτιολόγηση." width="90%"/>
</center>

**Θεώρημα:** Το ελάχιστο μήκος της $$Y$$, δίνεται με τον παραπάνω αλγόριθμο.

*Απόδειξη:* Ούτε το $$M$$ μπορεί να είναι μικρότερο, ούτε το $$L$$ μεγαλύτερο. Επομένως αυτή είναι η ελάχιστη διαφορά τους.

